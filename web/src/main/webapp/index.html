<!DOCTYPE html><html lang="en" class="chrometwo"><head><script type="text/javascript">window.pstart = new Date().getTime();
console.log("Start: " + window.pstart);</script><title>Embedded Vulnerability Detection</title><link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet"><!-- The overrides needs to come after the application css--><!-- Need in chrome2.css, look at source of http://handsbox-portal.usersys.redhat.com/pass/chrome_test/--><script data-main="/webassets/avalon/j/chrometwo" src="/webassets/avalon/j/lib/require.js"></script><link href="/webassets/avalon/s/bootstrap3.overrides.css" rel="stylesheet"></head><body class="chrometwo"><div id="chrometwo"><div id="main"><!-- Content area is required as per instruction from Marc Caron, otherwise box styling not honored--><div class="content-area"><div class="row"><div class="col-lg-6"><h4>Embedded Vulnerability Detection</h4><hr><div class="spacer clearfix"></div><form id="upload-form" role="form" enctype="multipart/form-data" class="form-horizontal"><div class="form-group"><label class="col-sm-12">Please select a JAR, POM, or Java Class file to analyze&nbsp;</label><div class="col-sm-12"><input id="upload" type="file"></div><div class="col-sm-12"><button id="form-submit" type="submit" class="btn btn-default">Submit
</button></div></div></form></div><div class="col-lg-6"><h4>Vulnerabilities Found</h4><hr><div class="spacer clearfix"></div><div id="results"></div></div></div></div></div></div><script type="text/javascript">chrometwo_require([], function() {
    $("head").prepend("<link rel=\"stylesheet\" type=\"text/css\" media=\"all\" href=\"/webassets/avalon/s/bootstrap3.min.css\" />");
    
    $("#upload").change(function() {
        var file = this.files[0];
        var name = file.name;
        var ext = name.split('.').pop();
        if (ext !== "class" && ext !== "jar" && ext !== "xml") {
            alert("Invalid file extension");
            return false;
        }
    });
    $('#form-submit').on('click', function (evt) {
        evt.preventDefault();
        var filename = $("#upload").val();
        if (filename === "") {
            alert("Please select a file to upload");
            return false;
        }
        var lastIndex = filename.lastIndexOf("\\");
        if (lastIndex >= 0) {
            filename = filename.substring(lastIndex + 1);
        }
        var ext = filename.split('.').pop();
        if (ext !== "class" && ext !== "jar" && ext !== "xml") {
            alert("Invalid file extension");
            return false;
        }
        $("#upload").prop("name", filename);
        var formData = new FormData($("#upload-form")[0]);
        $.ajax({
            url: 'api/check',
            type: 'POST',
            success: function(response) {
                var item = "<ul>"
                response.forEach(function(entry) {
                    item = item + "<li>"
                    var filename = entry.file;
                    item = item + filename + ": "
                    if (entry.vulnerabilities.length > 0) {
                        entry.vulnerabilities.forEach(function(ventry) {
                            item = item + "<a href='https://access.redhat.com/security/cve/" + ventry + "'>" + ventry + " </a>"
                        });
                        item = item + "</li>"
                    }
                    else {
                        item = item + "No vulnerabilities detected</li>"
                    }
                });
                $("#results").html(item);
            },
            data: formData,
            cache: false,
            contentType: false,
            processData: false
        });
    });
});</script></body></html>